<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">ESP32入门文档 | xiaojiaQQ&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "Yourlai'sBlog";
  mashiro_option.author_name = "Blog";
  mashiro_option.site_url = "http://yourlai.icu";
  mashiro_option.v_appId = "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz";
  mashiro_option.v_appKey = "mgOpfzbkHYqU92CV4IDlAUHQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(0).webp,https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(1).webp,https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(2).webp,https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(3).webp,https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(4).webp,https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(5).webp,https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/After_05254.jpg".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配这一块~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop ">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a target="_blank" rel="noopener" href="http://yourlai.icu">
          <img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/custom/ava_Little_size.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>Never stop . Never give up.</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="https://space.bilibili.com/396079395" target="_blank" class="social-github" title="Bilibili">
                    <img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/social/bilibili.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://music.163.com/#/user/home?id=1298327087" target="_blank" class="social-github" title="网易云音乐">
                    <img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/social/wangyiyun.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="http://yourlai.icu" target="_blank" class="social-github" title="博客主站">
                    <img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/social/blog.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="mailto:yourlai@yourlai.icu" target="_blank" class="social-github" title="Email">
                    <img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/social/email.svg">
                  </a>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">Yourlai&#39;s</span>
            <span class="shironeko">Blog</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    随便写的
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/wiki/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          Wiki
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/%E6%95%99%E7%A8%8B/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          教程
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/%E9%97%B2%E8%B0%88/">
                          <i class="fa fa-commenting-o" aria-hidden="true"></i>
                          闲谈
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/%E5%B0%8F%E8%AF%B4/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          小说
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    推荐
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/tags/%E6%82%A6%E8%AF%BB/">
                          <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                          书单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/bangumi/">
                          <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                          番组
                        </a>
                      </li>
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/%E5%9B%BE%E9%9B%86/">
                          <i class="fa fa-photo" aria-hidden="true"></i>
                          图集
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/about/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-question-circle faa-wrench" aria-hidden="true"></i>
                    关于本站
                  </span>
                </a>
                
              </li>
            
              <li>
                <a target="_blank" rel="noopener" href="http://ipv6.yourlai.icu">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    主站链接
                  </span>
                </a>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

  <div class="pattern-center single-center">
    <!-- 有配图默认渲染第一张 -->
    <div class="pattern-attachment-img lazyload" style="background-image: url(https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/After_05254.jpg);" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/After_05254.jpg">
    </div>
    <header class="pattern-header single-header">
      <h1 class="entry-title">
      ESP32入门文档</h1>
      <p class="entry-census">
        <span>
          <a href="">
            <img src="">
          </a>
        </span>
        <span>
          <a href=""></a>
        </span>
        <span class="bull">
        ·</span>
        2025-5-28<span class="bull">
        ·</span>
      <span id="busuanzi_value_page_pv"></span>次阅读</p>
    </header>
  </div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <p><strong>ESP32外设</strong></p>
<p><strong>入门文档</strong></p>
<p><strong>2025-05-28</strong></p>
<h1 id="写在前边"><a href="#写在前边" class="headerlink" title="写在前边"></a>写在前边</h1><p> 弄这个文档的初衷是为了更快地入门ESP32，一寻思自己弄太慢了，就大家一起来完善吧。 文档内容肯定会有错误，在群里说一下改正即可，如果进度比较快or有地方需要完善，按照已有格式进行完善即可，众人拾柴火焰高，对吧。</p>
<h1 id="文档说明"><a href="#文档说明" class="headerlink" title="文档说明"></a>文档说明</h1><p><strong>本文档中只说明ESP32中的情况</strong></p>
<p> 下边的函数或者某些参数如果没有看懂，需要结合PDF和AI了解。 <strong>文档的基本格式如下↓</strong></p>
<h1 id="某个大类1（使用”标题1”格式）"><a href="#某个大类1（使用”标题1”格式）" class="headerlink" title="某个大类1（使用”标题1”格式）"></a>某个大类1（使用”标题1”格式）</h1><p>然后是这个大类的简短介绍，包括具体使用流程等等。 <strong>1.具体流程1（使用”副标题”格式）(缩进一个TAB)</strong></p>
<p>包括具体的代码和介绍，介绍放代码前。（代码使用代码块填写）</p>
<p><strong>2.具体流程2（格式同上）</strong></p>
<p>包括具体的代码和介绍，介绍放代码前。</p>
<h1 id="某个大类2"><a href="#某个大类2" class="headerlink" title="某个大类2"></a>某个大类2</h1><p><strong>1.………………如此往下</strong> 目录</p>
<p><a href="#_Toc199185153">写在前边    2</a></p>
<p><a href="#_Toc199185154">文档说明    2</a></p>
<p><a href="#_Toc199185155">某个大类1（使用”标题1”格式）    2</a></p>
<p><a href="#_Toc199185156">1.具体流程1（使用”副标题”格式）(缩进一个TAB)    2</a></p>
<p><a href="#_Toc199185157">2.具体流程2（格式同上）    2</a></p>
<p><a href="#_Toc199185158">某个大类2    2</a></p>
<p><a href="#_Toc199185159">1.………………如此往下    2</a></p>
<p><a href="#_Toc199185160">GPIO    4</a></p>
<p><a href="#_Toc199185161">GPIO初始化    5</a></p>
<p><a href="#_Toc199185162">GPIO输出    5</a></p>
<p><a href="#_Toc199185163">GPIO交换矩阵    5</a></p>
<p><a href="#_Toc199185164">定时器    6</a></p>
<p><a href="#_Toc199185165">PWM    6</a></p>
<p><a href="#_Toc199185166">创建PWM配置结构体    6</a></p>
<p><a href="#_Toc199185167">使用API配置PWM    7</a></p>
<p><a href="#_Toc199185168">通道初始化    7</a></p>
<p><a href="#_Toc199185169">使用API进行绑定    8</a></p>
<p><a href="#_Toc199185170">计时计数    8</a></p>
<p><a href="#_Toc199185171">IIC协议：    8</a></p>
<p><a href="#_Toc199185172">文件中创建结构体初始化I2C    8</a></p>
<p><a href="#_Toc199185173">通过I2C对寄存器值进行读取写入（用于寄存器初始化函数中）    9</a></p>
<p><a href="#_Toc199185174">在主函数中调用初始化函数    9</a></p>
<p><a href="#_Toc199185175">串口（UART）    10</a></p>
<p><a href="#_Toc199185176">创建配置结构体    10</a></p>
<p><a href="#_Toc199185177">调用API配置结构体    10</a></p>
<p><a href="#_Toc199185178">安装UART驱动    11</a></p>
<p><a href="#_Toc199185179">读取串口数据    11</a></p>
<p><a href="#_Toc199185180">发送串口数据    11</a></p>
<p><a href="#_Toc199185181">更改串口引脚（可选）    11</a></p>
<p><a href="#_Toc199185182">WiFi    12</a></p>
<p><a href="#_Toc199185183">STA模式    12</a></p>
<p><a href="#_Toc199185184">初始化NVS，TCP&#x2F;IP，系统事件循环    12</a></p>
<p><a href="#_Toc199185185">初始化WIFI    12</a></p>
<p><a href="#_Toc199185186">设置事件回调函数    13</a></p>
<p><a href="#_Toc199185187">一键配网模式（SmartConfig）    15</a></p>
<p><a href="#_Toc199185188">MQTT    15</a></p>
<p><a href="#_Toc199185189">①MQTT基础设置    15</a></p>
<p><a href="#_Toc199185190">创建MQTT句柄    15</a></p>
<p><a href="#_Toc199185191">创建并填充结构体    15</a></p>
<p><a href="#_Toc199185192">调用配置结构体并初始化客户端    16</a></p>
<p><a href="#_Toc199185193">注册回调函数    16</a></p>
<p><a href="#_Toc199185194">启用MQTT    16</a></p>
<p><a href="#_Toc199185195">②配置MQTT事件回调函数    16</a></p>
<p><a href="#_Toc199185196">使用MQTT发送数据    18</a></p>
<p><a href="#_Toc199185197">初始化WIFI    19</a></p>
<p><a href="#_Toc199185198">监听WIFI连接事件    19</a></p>
<p><a href="#_Toc199185199">发布数据    19</a></p>
<p><a href="#_Toc199185200">JSON    20</a></p>
<p><a href="#_Toc199185201">解析JSON    20</a></p>
<p><a href="#_Toc199185202">解析JSON并保存    20</a></p>
<p><a href="#_Toc199185203">读取JSON中某个键的数据    20</a></p>
<p><a href="#_Toc199185204">读取获取数据的值    21</a></p>
<p><a href="#_Toc199185205">生成JSON    21</a></p>
<p><a href="#_Toc199185206">创建cJSON格式的对象    21</a></p>
<p><a href="#_Toc199185207">向对象中添加键-值    21</a></p>
<p><a href="#_Toc199185208">WS2812    21</a></p>
<p><a href="#_Toc199185209">结构体创建    22</a></p>
<p><a href="#_Toc199185210">先创建LED的配置结构体和被操控的LED对象    22</a></p>
<p><a href="#_Toc199185211">再创建RMT的配置结构体    22</a></p>
<p><a href="#_Toc199185212">调用API进行配置    22</a></p>
<p><a href="#_Toc199185213">配置LED亮度等参数    22</a></p>
<p><a href="#_Toc199185214">DHT11    23</a></p>
<p><a href="#_Toc199185215">初始化DHT11    23</a></p>
<p><a href="#_Toc199185216">调用rmt接受通道    23</a></p>
<p><a href="#_Toc199185217">使用队列接收数据    24</a></p>
<p><a href="#_Toc199185218">将RMT读取到的脉冲数据处理为温度和湿度    24</a></p>
<p><a href="#_Toc199185219">调整脉冲信号以接受DHT11数据    25</a></p>
<p><a href="#_Toc199185220">LCD液晶显示屏    25</a></p>
<p><a href="#_Toc199185221">初始化PCA8559    26</a></p>
<p><a href="#_Toc199185222">读写PCA8559    26</a></p>
<p><a href="#_Toc199185223">控制PCA9557任意一个单独引脚变高变低    27</a></p>
<p><a href="#_Toc199185224">控制PCA9557_LCD_CS输出高低电平    28</a></p>
<p><a href="#_Toc199185225">初始化I2C    29</a></p>
<p><a href="#_Toc199185226">初始化LCD    29</a></p>
<p><a href="#_Toc199185227">使用ESP32中遇到的奇奇怪怪的问题    29</a></p>
<p><a href="#_Toc199185228">1.    明明添加了”esp_log.h”这种头文件，但是根本识别不到该怎么办？    29</a></p>
<p><a href="#_Toc199185229">2.    编译卡在CMake过不去，但是检查了一圈程序发现没问题    29</a></p>
<p><a href="#_Toc199185230">3.    明明头文件设置好了，但是头文件中的函数无法调用怎么办？    29</a></p>
<h1 id="GPIO"><a href="#GPIO" class="headerlink" title="GPIO"></a>GPIO</h1><p>GPIO有四种常见的工作模式： 输出：可以设置GPIO的高低电平 输入：可以获取外部输入的高低电平信息，一般要设置加上拉电阻或下拉电阻 浮空输出：可以设置GPIO的高低电平，但要在电路外部中增加上拉电阻 开漏输入：可以获取外部输入的高低电平信息，但要在电路外部中增加上拉电阻 GPIO的使用流程： 初始化-&gt;设置GPIO工作模式 <strong>GPIO初始化</strong> 定义结构体-&gt;调用API初始化GPIO ①定义结构体 结构体由以下内容组成 ②使用API初始化GPIO <strong>GPIO输出</strong> 输出的两个参数分别是： gpio_num：GPIO引脚编号（如GPIO_NUM_2）。 level：电平值（0&#x2F;1） 这里level非零即为1 <strong>GPIO交换矩阵</strong> GPIO交换矩阵的核心作用： 动态信号路由：允许将90%以上的外设信号（如UART、PWM、SPI等）自由映射到 任意可用的GPIO引脚（部分特殊功能引脚除外）。 突破物理限制：解决PCB设计时的引脚冲突问题，例如可将同一外设（如 UART0）的TX和RX分配到不同位置的引脚。 简而言之，可以让任意引脚使用任意的功能。</p>
<h1 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h1><p><strong>PWM</strong> 定时器是通道的基础. 通道必须绑定到一个已通过ledc_timer_config配置的定时器。定时器定义了PWM的全局参数（如频率），而通道负责将这一时间基准转化为具体GPIO的输出。 共享性: 一个定时器可被多个通道共享。例如，定时器配置为1kHz频率后，多个通道可基于同一频率输出不同占空比的信号。 参数一致性: 通道的speed_mode必须与绑定的定时器一致，否则PWM信号无法正确生成。 配置流程：配置PWM,绑定通道和GPIO ①配置PWM：创建PWM配置结构体-&gt;通过API使用结构体对PWM的定时器进行配置 ②绑定：完成通道绑定设置-&gt;通过API使用结构体对PWM的定时器进行绑定</p>
<h3 id="创建PWM配置结构体"><a href="#创建PWM配置结构体" class="headerlink" title="创建PWM配置结构体"></a>创建PWM配置结构体</h3><p>对PWM进行初始化设置，设置定时器频率、通道，时钟源，翻转频率，分辨率</p>
<p>↓↓ESP32的时钟源类型↓↓</p>
<p>时钟源类型</p>
<p>频率范围</p>
<p>适用模式</p>
<p>特点</p>
<p>APB_CLK </p>
<p>80MHz（默认）</p>
<p>高速模式</p>
<p>高精度、低抖动 </p>
<p>RTC8M_CLK </p>
<p>~8MHz（可校准）</p>
<p>低速模式</p>
<p>低功耗、可深度睡眠工作</p>
<p>REF_TICK </p>
<p>1MHz</p>
<p>特殊应用</p>
<p>同步系统时钟</p>
<p><strong>此处一般为自动</strong></p>
<h3 id="使用API配置PWM"><a href="#使用API配置PWM" class="headerlink" title="使用API配置PWM"></a>使用API配置PWM</h3><p>ledc_timer_config用于初始化用到的定时器（）</p>
<h3 id="通道初始化"><a href="#通道初始化" class="headerlink" title="通道初始化"></a>通道初始化</h3><p>指定配置的通道，及其绑定的定时器与GPIO，并指明定时器频率，中断类型和信号占空比</p>
<h3 id="使用API进行绑定"><a href="#使用API进行绑定" class="headerlink" title="使用API进行绑定"></a>使用API进行绑定</h3><p>ledc_channel_config用于初始化ledc输出通道 以及将timer关联起来 这样对应的通道就能输出PWM频率了（上例为On_Board_LED_GPIO这个GPIO接口输出PWM） <strong>计时计数</strong></p>
<h1 id="IIC协议："><a href="#IIC协议：" class="headerlink" title="IIC协议："></a>IIC协议：</h1><p>注意！注意！新旧I2C协议代码不通用！不兼容！ 旧版”driver&#x2F;i2c.h” 新版”driver&#x2F;i2c_master.h” 配置流程：写初始化I2C函数，写I2C对寄存器读写函数（用于寄存器初始化函数中），主函数调用I2C初始化函数与寄存器初始化函数 ①配置I2C：创建I2C初始化结构体-&gt;配置参数-&gt;安装I2C驱动 ②寄存器读写函数-&gt;寄存器初始化函数需要用到寄存器值读写 ③在主函数中调用I2C初始化函数与寄存器初始化函数</p>
<h2 id="文件中创建结构体初始化I2C"><a href="#文件中创建结构体初始化I2C" class="headerlink" title="文件中创建结构体初始化I2C"></a>文件中创建结构体初始化I2C</h2><h2 id="通过I2C对寄存器值进行读取写入（用于寄存器初始化函数中）"><a href="#通过I2C对寄存器值进行读取写入（用于寄存器初始化函数中）" class="headerlink" title="通过I2C对寄存器值进行读取写入（用于寄存器初始化函数中）"></a>通过I2C对寄存器值进行读取写入（用于寄存器初始化函数中）</h2><p>BSP_I2C_NUM依旧是使用的I2C外设编号，SENSOR_ADDR是寄存器的地址，I2C通过地址找到寄存器并进行读写操作。</p>
<h2 id="在主函数中调用初始化函数"><a href="#在主函数中调用初始化函数" class="headerlink" title="在主函数中调用初始化函数"></a>在主函数中调用初始化函数</h2><p>ESP_ERROR_CHECK 是一个宏函数，位于 esp-idf 文件中，用于检测执行函数的返回结果，如果没有错误，什么事情都不会发生，如果有错误，会引起单片机重启。使用这个宏函数，需要包含 esp_err.h 头文件。</p>
<h1 id="串口（UART）"><a href="#串口（UART）" class="headerlink" title="串口（UART）"></a>串口（UART）</h1><p>使用方法与其他的配置大同小异 使用流程：创建配置结构体-&gt;调用结构体进行配置-&gt;安装驱动（设置RX&#x2F;TX缓冲区）-&gt;读取&#x2F;发送 <strong>创建配置结构体</strong></p>
<p>baud_rate</p>
<p>波特率</p>
<p>设置数据传输速率，单位是每秒比特数（bps）</p>
<p>data_bits</p>
<p>数据位</p>
<p>定义每个数据包的位数</p>
<p>parity</p>
<p>校验位</p>
<p>错误检测机制，检测单比特错误</p>
<p>stop_bits</p>
<p>停止位</p>
<p>标识数据包结束的位数</p>
<p>flow_ctrl</p>
<p>流控制</p>
<p>防止数据溢出的硬件流控</p>
<p>source_clk</p>
<p>时钟源</p>
<p>选择 UART 的基准时钟源</p>
<p>这里对流控制进一步解释（因为我也不会） 流控制的作用： 防止数据溢出：当接收方缓冲区满时，通过流控制信号让发送方暂停传输。 保证传输可靠性：避免高速发送导致低速接收设备无法处理数据。 适应不同硬件性能：协调不同处理速度的设备（如MCU与PC）之间的通信。 硬件流控制（通过物理引脚信号控制数据流）： RTS（RequestToSend）：接收方准备好接收数据时，拉高此信号。 CTS（ClearToSend）：发送方检测到CTS有效时，才允许发送数据。 <strong>调用API配置结构体</strong> 这里UART_PORT_NUM是串口号 （ESP32芯片通常包含3个独立的UART硬件控制器，串口0默认串口下载，串口1一般为FLASH的引脚（可通过GPIO交换矩阵更改引脚），串口2常用） <strong>安装UART驱动</strong> 串口号-发送缓存大小-接收缓存大小-队列长度-队列句柄（传回来用的）-中断标志（一般使用0，使用默认配置） <strong>读取串口数据</strong> 这函数有返回值：如果成功，则返回读取的字节数；失败则返回-1。 串口号-缓冲区-缓冲区大小-等待数据的超时时间 portMAX_DELAY表示无限等待 <strong>发送串口数据</strong> 串口号-待发送数据的源地址-发送数据的字节数 <strong>更改串口引脚（可选）</strong> 通过GPIO矩阵，将默认的串口引脚更改。若更改，则需在安装驱动前配置该项。</p>
<h1 id="WiFi"><a href="#WiFi" class="headerlink" title="WiFi"></a>WiFi</h1><p><strong>STA模式</strong> STA模式：连接已有的网络，ESP32作为终端设备 使用流程： 总流程：创建并初始化函数-&gt;监听设备事件-&gt;分情况调用回调函数进行各项初始化和配置 初始化流程：初始化NVS（存储SSID和密码），初始化TCP&#x2F;IP栈（使用esp_netif_init），初始化事件系统循环（存储系统事件，包括WIFI MQTT BLU等），初始化WIFI，设置事件回调函数并监听事件</p>
<h3 id="初始化NVS，TCP-IP，系统事件循环"><a href="#初始化NVS，TCP-IP，系统事件循环" class="headerlink" title="初始化NVS，TCP&#x2F;IP，系统事件循环"></a>初始化NVS，TCP&#x2F;IP，系统事件循环</h3><h3 id="初始化WIFI"><a href="#初始化WIFI" class="headerlink" title="初始化WIFI"></a>初始化WIFI</h3><p>先定义个WIFI初始化结构体-&gt;再创建个设置STA的初始化结构体-&gt;调用API进行初始化（WIFI和WIFI设置）-&gt;启动WIFI</p>
<h3 id="设置事件回调函数"><a href="#设置事件回调函数" class="headerlink" title="设置事件回调函数"></a>设置事件回调函数</h3><p>WIFI事件的回调函数 事件回调函数有以下几个要素：</p>
<ol>
<li><p>有个能被调用的”注册回调函数的接口”（就是将回调函数与事件进行绑定）</p>
</li>
<li><p>有个回调函数（被调用之后产生的动作）</p>
</li>
</ol>
<p>WIFI需要注册多个回调函数：WIFI和网络（IP_EVENT） 这里的事件回调函数，主要是为了判断WIFI的各个事件段该做什么，比如未连接WiFi怎么办，获取ip之后怎么办。 <strong>一键配网模式（SmartConfig）</strong></p>
<h1 id="MQTT"><a href="#MQTT" class="headerlink" title="MQTT"></a>MQTT</h1><p>基于TCP&#x2F;IP的低带宽需求报文传输服务 使用流程： ①创建MQTT句柄（通过这个对MQTT进行操作）-&gt;创建并调用结构体（存储初始化MQTT的参数）-&gt;②-&gt;注册回调函数-&gt;启用MQTT ②配置事件回调函数，对MQTT各个状态进行反应（对订阅、发布、接收数据等进行操作） <strong>①MQTT基础设置</strong></p>
<h3 id="创建MQTT句柄"><a href="#创建MQTT句柄" class="headerlink" title="创建MQTT句柄"></a>创建MQTT句柄</h3><p>这里实际上创建了一个MQTT客户端，名为s_mqtt_client 后续所有对MQTT客户端的操作，都使用s_mqtt_client</p>
<h3 id="创建并填充结构体"><a href="#创建并填充结构体" class="headerlink" title="创建并填充结构体"></a>创建并填充结构体</h3><h3 id="调用配置结构体并初始化客户端"><a href="#调用配置结构体并初始化客户端" class="headerlink" title="调用配置结构体并初始化客户端"></a>调用配置结构体并初始化客户端</h3><h3 id="注册回调函数"><a href="#注册回调函数" class="headerlink" title="注册回调函数"></a>注册回调函数</h3><p>为 MQTT 客户端注册事件回调函数。具体来说：</p>
<ol>
<li><p>调用 esp_mqtt_client_register_event() 来关联 MQTT 客户端 s_mqtt_client 和事件回调函数aliot_mqtt_event_handler。</p>
</li>
<li><p>指定 ESP_EVENT_ANY_ID 表示接收所有类型的 MQTT 事件（例如连接、断开、发布、订阅、接收数据等）。</p>
</li>
<li><p>回调函数中可以根据事件类型（event_id）做出相应处理，例如记录日志、修改连接状态或发布配置信息。</p>
</li>
<li><p>最后传入 s_mqtt_client 作为用户数据，这样在回调中可以访问到该 MQTT 客户端句柄或相关信息。</p>
</li>
</ol>
<h3 id="启用MQTT"><a href="#启用MQTT" class="headerlink" title="启用MQTT"></a>启用MQTT</h3><p><strong>②配置MQTT事件回调函数</strong> 可以用这个回调函数直接读取MQTT订阅的数据 配置方式与WIFI大差不差 注：</p>
<p><strong>使用MQTT发送数据</strong></p>
<p>发送流程： NVS 是 Non-Volatile Storage（非易失性存储）的缩写，是 ESP32 用来持久化保存数据的一种机制。 它类似于”小型文件系统”，常用于保存 WiFi 配置、密钥、参数等，即使断电数据也不会丢失。 此处，NVS 主要用于保证系统能正常保存和读取配置信息。</p>
<h3 id="初始化WIFI-1"><a href="#初始化WIFI-1" class="headerlink" title="初始化WIFI"></a>初始化WIFI</h3><p>传入回调函数，用于通知连接成功事件</p>
<h3 id="监听WIFI连接事件"><a href="#监听WIFI连接事件" class="headerlink" title="监听WIFI连接事件"></a>监听WIFI连接事件</h3><p>直到WiFi连接成功后，才启动MQTT连接</p>
<h3 id="发布数据"><a href="#发布数据" class="headerlink" title="发布数据"></a>发布数据</h3><h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>JSON是一种规范好的数据格式，本质上就是字符串。用于传输数据信息，基于”键-值对”，可以包含对象、数组、字符串、数字、布尔、NULL这六种最基本的数据。 ESP32中可以使用cJSON数据解析器来分析和打包JSON数据，需要调用”cJSON.h”。 JSON的基本格式如下 <strong>解析JSON</strong> 流程：解析JSON-&gt;……&gt;解析JSON-&gt;读取键的数据-&gt;读取数据的值</p>
<h3 id="解析JSON并保存"><a href="#解析JSON并保存" class="headerlink" title="解析JSON并保存"></a>解析JSON并保存</h3><p>本文档中只说明ESP32中的情况</p>
<h3 id="读取JSON中某个键的数据"><a href="#读取JSON中某个键的数据" class="headerlink" title="读取JSON中某个键的数据"></a>读取JSON中某个键的数据</h3><p>这里的数据，可以是具体的数值和字符串，也可以是对象。 若JSON层层嵌套，则需层层解析。重复使用cJSON_GetObjectItem，一层一层解析，以下操作也同理</p>
<h3 id="读取获取数据的值"><a href="#读取获取数据的值" class="headerlink" title="读取获取数据的值"></a>读取获取数据的值</h3><p>如果要获取数据的值为字符串，则用cJSON_GetStringValue() 如果是数值，则用cJSON_GetNumberValue() <strong>生成JSON</strong> 流程：创建cJSON格式的对象-&gt;向对象中添加键-值</p>
<h3 id="创建cJSON格式的对象"><a href="#创建cJSON格式的对象" class="headerlink" title="创建cJSON格式的对象"></a>创建cJSON格式的对象</h3><p>这里创建了个名为js_obj_tx_humidity的cJSON对象。</p>
<h3 id="向对象中添加键-值"><a href="#向对象中添加键-值" class="headerlink" title="向对象中添加键-值"></a>向对象中添加键-值</h3><p>这里向js_obj_tx_humidity这个对象中添加的键-值为”Humidity”,”%d” 然后向js_obj_tx_humidity这个对象中又添加了一个对象js_obj_sys</p>
<h1 id="WS2812"><a href="#WS2812" class="headerlink" title="WS2812"></a>WS2812</h1><p>以下是调用已有配置对WS2812进行驱动 单总线控制的彩色LED灯珠，因为对控制时序比较严格，故使用RMT红外控制。 同GPIO等操作方式，需先使用结构体进行初始化，再使用API通过结构体配置。 Tips：使用”led_strip.h” 使用流程（基于官方Example）： 创建结构体（共两个）-&gt;调用API进行配置-&gt;使用函数配置亮度颜色等参数 <strong>结构体创建</strong></p>
<h3 id="先创建LED的配置结构体和被操控的LED对象"><a href="#先创建LED的配置结构体和被操控的LED对象" class="headerlink" title="先创建LED的配置结构体和被操控的LED对象"></a>先创建LED的配置结构体和被操控的LED对象</h3><h3 id="再创建RMT的配置结构体"><a href="#再创建RMT的配置结构体" class="headerlink" title="再创建RMT的配置结构体"></a>再创建RMT的配置结构体</h3><p><strong>调用API进行配置</strong> 使用led_strip_new_rmt_device函数 利用传递进来两个参数（LED和RMT的配置结构体），生成到先前创建的LED对象（led_strip）中 <strong>配置LED亮度等参数</strong> 对生成的对象（led_strip）,进行参数配置；配置后刷新LED状态 这样WS2812就会常亮了 <strong>（不基于BLink例程）以下是从RMT驱动开始，驱动WS2812</strong> <strong>基于此帖子（<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tcjiaan/p/18147955"></a></strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/tcjiaan/p/18147955">【ESP32 IDF】用RMT控制 WS2812 彩色灯带 - 东邪独孤 - 博客园**）**</a>[</p>
<h1 id="DHT11"><a href="#DHT11" class="headerlink" title="DHT11"></a>DHT11</h1><p>单总线工作的数字温湿度传感器，工作范围”-20<del>60摄氏度””5%</del>90%” DHT11基于单总线，同样利用RMT红外进行控制（接收数据）。 工作流程： 定义RMT接收用结构体-&gt;调用RMT接收通道API-&gt;使用队列接收数据-&gt;接收完使用回调至接收模式</p>
<p><strong>初始化DHT11</strong></p>
<p><strong>调用rmt接受通道</strong></p>
<p><strong>使用队列接收数据</strong></p>
<p><strong>将RMT读取到的脉冲数据处理为温度和湿度</strong></p>
<p>脉冲信号处理，复制即可</p>
<p><strong>调整脉冲信号以接受DHT11数据</strong></p>
<p>脉冲信号调整部分复制即可 调整后接收数据</p>
<h1 id="LCD液晶显示屏"><a href="#LCD液晶显示屏" class="headerlink" title="LCD液晶显示屏"></a>LCD液晶显示屏</h1><p>这里采用液晶屏驱动芯片ST7789，采用SPI通信方式与ESP32连接. 由于esp32的引脚数量少，可以使用寄存器PCA9557，对远程位置上的输入输出控制和状态监控，用于解决微控制器I&#x2F;O资源不足的问题，并允许通过简单的I2C接口实现复杂的I&#x2F;O操作。 液晶屏的LCD_CS引脚由IO扩展芯片pca9557控制，所以需要先初始化pca9557，而pca9557是i2c通信芯片，所以又需要先初始化i2c。</p>
<h2 id="初始化PCA8559"><a href="#初始化PCA8559" class="headerlink" title="初始化PCA8559"></a>初始化PCA8559</h2><p>首先需要设置PCA9557的工作模式（如输入或输出）。这是通过向特定寄存器写入配置数据完成的。</p>
<h2 id="读写PCA8559"><a href="#读写PCA8559" class="headerlink" title="读写PCA8559"></a>读写PCA8559</h2><h2 id="控制PCA9557任意一个单独引脚变高变低"><a href="#控制PCA9557任意一个单独引脚变高变低" class="headerlink" title="控制PCA9557任意一个单独引脚变高变低"></a>控制PCA9557任意一个单独引脚变高变低</h2><h2 id="控制PCA9557-LCD-CS输出高低电平"><a href="#控制PCA9557-LCD-CS输出高低电平" class="headerlink" title="控制PCA9557_LCD_CS输出高低电平"></a>控制PCA9557_LCD_CS输出高低电平</h2><h2 id="初始化I2C"><a href="#初始化I2C" class="headerlink" title="初始化I2C"></a>初始化I2C</h2><h2 id="初始化LCD"><a href="#初始化LCD" class="headerlink" title="初始化LCD"></a>初始化LCD</h2><p><strong>使用ESP32中遇到的奇奇怪怪的问题</strong></p>
<ol>
<li><h3 id="明明添加了”esp-log-h”这种头文件，但是根本识别不到该怎么办？"><a href="#明明添加了”esp-log-h”这种头文件，但是根本识别不到该怎么办？" class="headerlink" title="明明添加了”esp_log.h”这种头文件，但是根本识别不到该怎么办？"></a>明明添加了”esp_log.h”这种头文件，但是根本识别不到该怎么办？</h3><ol>
<li><p>ESP-IDF的路径设置对了吗。</p>
</li>
<li><p>需要用”ESP-IDF: 添加 VS Code 配置文件夹”给这个项目添加以下配置文件夹</p>
</li>
</ol>
</li>
<li><h3 id="编译卡在CMake过不去，但是检查了一圈程序发现没问题"><a href="#编译卡在CMake过不去，但是检查了一圈程序发现没问题" class="headerlink" title="编译卡在CMake过不去，但是检查了一圈程序发现没问题"></a>编译卡在CMake过不去，但是检查了一圈程序发现没问题</h3><ol>
<li>删掉build文件夹，再重新编译一下</li>
</ol>
</li>
<li><h3 id="明明头文件设置好了，但是头文件中的函数无法调用怎么办？"><a href="#明明头文件设置好了，但是头文件中的函数无法调用怎么办？" class="headerlink" title="明明头文件设置好了，但是头文件中的函数无法调用怎么办？"></a>明明头文件设置好了，但是头文件中的函数无法调用怎么办？</h3><p>1）在CMakeLists.txt中，按照格式把需要编译的.C程序添加进去（根据已有的格式设置就行）</p>
</li>
</ol>
<p>](<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tcjiaan/p/18147955">https://www.cnblogs.com/tcjiaan/p/18147955</a>)</p>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/custom/donate/AliPayQR.jpg"></li>
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/custom/donate/WeChanQR.jpg"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2025/06/25/%E6%9B%B4%E5%A5%BD%E5%9C%B0%E7%94%A8ai%E8%BE%85%E5%8A%A9/" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(3).webp" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/(3).webp">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                更好地用AI辅助</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2025/05/21/%E5%9B%BE%E7%89%87%E5%A2%99/" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/After_05239.jpg" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/hexo/After_05239.jpg">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                图片墙</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz",
        appKey: "mgOpfzbkHYqU92CV4IDlAUHQ",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>




      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="" class="profile gravatar"><img src="" itemprop="image" alt="" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="" itemprop="url" rel="author"></a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i></p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2025 Yourlai<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #62b8ed;"><a target="_blank" rel="noopener" href="http://ipv6.yourlai.icu" style="color: #62b8ed; text-decoration: none;">Yourlai &copy; 2025</a></p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #60bfe4;">Powered by Hexo, Hosted by Coding Pages</span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/yourlai2015/cdn/img/custom/ava_Little_size.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">Yourlai'sBlog</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="https://space.bilibili.com/396079395" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
        <a href="https://music.163.com/#/user/home?id=1298327087" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
        <a href="http://yourlai.icu" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
        <a href="mailto:yourlai@yourlai.icu" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            随便写的
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/wiki/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  Wiki
                </a>
              </li>
            
              <li>
                <a href="/categories/%E6%95%99%E7%A8%8B/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  教程
                </a>
              </li>
            
              <li>
                <a href="/categories/%E9%97%B2%E8%B0%88/">
                  <i class="fa fa-commenting-o" aria-hidden="true"></i>
                  闲谈
                </a>
              </li>
            
              <li>
                <a href="/categories/%E5%B0%8F%E8%AF%B4/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  小说
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            推荐
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/tags/%E6%82%A6%E8%AF%BB/">
                  <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                  书单
                </a>
              </li>
            
              <li>
                <a href="/bangumi/">
                  <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                  番组
                </a>
              </li>
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/tags/%E5%9B%BE%E9%9B%86/">
                  <i class="fa fa-photo" aria-hidden="true"></i>
                  图集
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/about/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-question-circle faa-wrench" aria-hidden="true"></i>
            关于本站
          </span>
        </a>
        
      </li>
    
      <li>
        <a target="_blank" rel="noopener" href="http://ipv6.yourlai.icu">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            主站链接
          </span>
        </a>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">Yourlai  &copy 2025</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #14ccff;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="13308314083"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="true"

    loop="all"

    order="random"

    preload="auto"

    volume="0.7"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>
</html>